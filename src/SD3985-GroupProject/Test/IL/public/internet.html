<!doctype html> 
<html lang="en"> 
<head> 
    <meta charset="UTF-8" />
    <title>Making your first Phaser 3 Game - Part 1</title>
    <script src="//cdn.jsdelivr.net/npm/phaser@3.11.0/dist/phaser.js"></script>
    <style type="text/css">
        body {
            margin: 0;
        }
    </style>
</head>
<body>

<script type="text/javascript">

var config = {
    type: Phaser.AUTO,
    width: 800,
    height: 600,
    backgroundColor: '#2d2d2d',
    parent: 'phaser-example',
    scene: {
        preload: preload,
        create: create
    }
};

var game = new Phaser.Game(config);
var random_boolean = Math.random() >= 0.5;
var number = Math.floor(Math.random() * 3) + 1; // random num 1 to 4
var group;
var bool_check_pt = [false, false, false, false, false];

function preload ()
{
    this.load.image('lemming', 'assets/star.png');
    this.load.image('star', 'assets/star.png');
}

function create ()
{
    // We define a list of points.
    var points = [
        [], // point1
        [], // point2
        [], // point3
        [], // point4
        [], // point5
        [], // point6
        [], // point7
    ];    

    
    // Description: create lines for points variable.
    // Usage: [startpointx, startpointy, endpointx, endpointy]
    var point_val = [
        [175, 180, 235, 180], // for line1
        [175, 130, 175, 180],
        [115, 130, 175, 130],
        [235, 180, 295, 230],
        [295, 230, 295, 280],
        [115, 130, 115, 270],
    ];

    group = this.add.group();

    group.createMultiple({ key: 'star', frame: 0, frameQantity:1, repeat: 15});
    Phaser.Actions.GridAlign(group.getChildren(), { width: 4, cellWidth: 60, cellHeight: 48, x: 132, y: 148 });
    
    var stars = group.getChildren();
    
    // (cell width, cell height)
    // 180 - 130 = 50 (cell height) approx
    // 175 - 115 = 60 (cell width) approx

    // Description: add points Vector2 to the point array
    // Usage: Specify the start points and end point in the point_val variable, don't modify the for loop.
    for (var i = 0; i < point_val.length ; i++)
    {
        points[i].push(new Phaser.Math.Vector2(point_val[i][0], point_val[i][1]));
        points[i].push(new Phaser.Math.Vector2(point_val[i][2], point_val[i][3]));
    }


    // Create curve variable to draw curves
    var curve = [];

    for (var i =0; i < point_val.length; i++)
        curve.push(new Phaser.Curves.Spline(points[i]));

    var graphics = this.add.graphics();

    graphics.lineStyle(1, 0xffffff, 1);

    graphics.fillStyle(0x00ff00, 1);

    //  On each click, draw a line
    this.input.on('pointerup', function (event) {

        if(checkpoint())
            return;
        number = Math.floor(Math.random() * 6); // random num 1 to 5
        console.log(number);

        switch (number){
            case 0:
                curve[0].draw(graphics, 64);
                bool_check_pt[0] = true;
                break;
            case 1:
                curve[1].draw(graphics, 64);
                bool_check_pt[1] = true;
                break;
            case 2:
                curve[2].draw(graphics, 64);
                bool_check_pt[2] = true;
                break;
            case 3:
                curve[3].draw(graphics, 64);
                bool_check_pt[3] = true;
                break;
            case 4:
                curve[4].draw(graphics, 64);
                bool_check_pt[4] = true;
                break;
            case 5:
                curve[5].draw(graphics, 64);
                break;
            default:
                console.log("Invalid num");
                break;
        }

        if (checkpoint())
            console.log("done");


    }, this);
   


}

function checkpoint()
{
    for (var i = 0; i < 5; i++)
    {
        if (bool_check_pt[i] == false)
            return false;
    }
        return true;
}

</script>

</body>
</html>