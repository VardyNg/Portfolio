<!doctype html> 
<html lang="en"> 
<head> 
    <meta charset="UTF-8" />
    <title>Making your first Phaser 3 Game - Part 7</title>
    <script src="//cdn.jsdelivr.net/npm/phaser@3.11.0/dist/phaser.js"></script>
    <style type="text/css">
        body {
            margin: 0;
        }
    </style>
</head>
<body>
<script type="text/javascript">
var config = {
    type: Phaser.AUTO,
    width: 960,
    height: 540,
    scene: {
        preload: preload,
        create: create,
		update: update
    },
	physics: {
        default: 'arcade',
        arcade: {
            gravity: { y: 0 }, //-50
            debug: true
        }
    },
	pixelArt: true
};

var game = new Phaser.Game(config);
var currentService = "telnet";
var currentServiceImage;
var currentServiceCount = 0; //need to be changed to be 0 again if service is changed.
var timedEvent;
var rebootImage;
var isReboot = false; //is reboot needed
var isCreateReboot = true; //can the reboot window be created. (no double reboot window at once)


function preload ()
{
	this.load.image('background', 'assets/background_test.png');
	this.load.image('httpApplication', 'assets/http_application.png');
	this.load.image('ftpApplication', 'assets/ftp_application.png');
	this.load.image('telnetApplication', 'assets/telnet_application.png');
	this.load.image('reboot', 'assets/reboot.png');
}

function create ()
{	
	this.add.image(480, 270, 'background');//create background image
	currentServiceImage = this.add.image(480, 270, 'httpApplication');
	
	timedEvent = this.time.addEvent({ delay: Math.random() * 2500 + 5000, callback: createReboot, callbakScope: this, loop: true });	
	
}
function update ()
{	
	if(currentService == "http" && currentServiceCount == 0)
	{
		currentServiceImage.destroy();
		currentServiceImage = null;
		currentServiceImage = this.add.image(480, 270, 'httpApplication');
		currentServiceCount = 1;
	}
	else if(currentService == "ftp" && currentServiceCount == 0)
	{
		currentServiceImage.destroy();
		currentServiceImage = null;
		currentServiceImage = this.add.image(480, 270, 'ftpApplication');
		currentServiceCount = 1;
	}
	else if(currentService == "telnet" && currentServiceCount == 0)
	{
		currentServiceImage.destroy();
		currentServiceImage = null;
		currentServiceImage = this.add.image(480, 270, 'telnetApplication');
		currentServiceCount = 1;
	}
	
	//create reboot window
	if(isReboot == true)
	{
		rebootImage = this.add.image(480, 270, 'reboot').setInteractive();
		rebootImage.once('pointerdown', reboot, this);
		isCreateReboot = false;
	}
	
}

//destory the applicaton
function createReboot ()
{
	if(isCreateReboot == true)
	{
		currentServiceImage.destroy();
		currentServiceImage = null;
		isReboot = true;
	}
}

//rebooted and back to the application scene
function reboot ()
{
	console.log("Clicked");
	isReboot = false;
	isCreateReboot = true;
	currentServiceImage = this.add.image(480, 270, 'httpApplication'); //original in the create funtion
	currentServiceCount = 0; //origainal value in the create function
}

</script>
</body>
</html>































